"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[465],{3465:(Y,u,r)=>{r.r(u),r.d(u,{TravelModule:()=>N});var c=r(6895),o=r(4006),v=r(5593),T=r(819),m=r(5479);class g{constructor(i){this.travelId=i}}var e=r(8274),d=r(4325),f=r(7468),b=r(529);let h=(()=>{class a{constructor(t){this.http=t,this.url=f.T+"travel"}getAll(){return this.http.get(this.url+"/getAllTravel",{observe:"response"})}getAllNotDeleted(){return this.http.get(this.url+"/getAllNotDeletedTravel",{observe:"response"})}create(t){return this.http.post(this.url+"/createTravel",t)}update(t){return this.http.put(this.url+"/editTravel",t)}delete(t){return this.http.delete(`${this.url}/deleteTravel/${t}`)}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(b.eN))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var p=r(805),y=r(1998);let C=(()=>{class a{constructor(t,l,n,s,k,J){this.fb=t,this.ref=l,this.config=n,this.travelService=s,this.messageService=k,this.changeDateService=J,this.travelForm=this.fb.group({name:["",o.kI.required],surname:["",o.kI.required],email:["",[o.kI.required,o.kI.email]],birthDay:["",[o.kI.required]],phoneNumber:["",[o.kI.required,o.kI.pattern("[0-9]{11}")]],city:["",o.kI.required],postalCode:["",o.kI.required],street:["",o.kI.required],streetNumber:["",o.kI.required]}),this.travel=new g,this.edit=!1}ngOnInit(){this.edit=this.config.data.edit,this.edit&&(this.travel=this.config.data.travel)}onEditTravel(){this.travelService.update(this.travel).subscribe({next:t=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"edytowano!"}),this.ref.close(t)},error:t=>{this.messageService.add({key:"mainToast",severity:"error",summary:"Error",detail:"nie edytowano!"})}})}onCreateTravel(){this.travelService.create(this.travel).subscribe({next:t=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"utworzono!"}),this.ref.close(t)},error:t=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"utworzono!"})}})}onCloseDialog(){this.ref.close()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(o.QS),e.Y36(d.E7),e.Y36(d.S),e.Y36(h),e.Y36(p.ez),e.Y36(y.H))},a.\u0275cmp=e.Xpm({type:a,selectors:[["fixtab-travel-dialog"]],decls:8,vars:3,consts:[[1,"dialog-content"],[1,"dialog-body"],[1,"dialog-form",3,"formGroup"],["form","ngForm"],[1,"dialog-footer"],["styleClass","button-width dialog-button-margin",3,"label","disabled","onClick"],["styleClass","button-width dialog-button-margin",3,"onClick"]],template:function(t,l){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"form",2,3),e.qZA(),e.TgZ(4,"div",4)(5,"p-button",5),e.NdJ("onClick",function(){return l.edit?l.onEditTravel():l.onCreateTravel()}),e.qZA(),e.TgZ(6,"p-button",6),e.NdJ("onClick",function(){return l.onCloseDialog()}),e._uU(7,"Anuluj"),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",l.travelForm),e.xp6(3),e.Q6J("label",l.edit?"Edytuj":"Dodaj")("disabled",l.travelForm.invalid))},dependencies:[v.zx,o._Y,o.JL,o.sg],encapsulation:2}),a})();var D=r(9767),S=r(5378),A=r(434);function E(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"fixtab-delete-dialog",4),e.NdJ("deleteConfirmationEmit",function(n){e.CHM(t);const s=e.oxw();return e.KtG(s.handleTravelDeleteDialog(n))}),e.qZA()}}const I=[{path:"travel",component:(()=>{class a{constructor(t,l,n){this.dialogService=t,this.routeService=l,this.messageService=n,this.selectedTravel=null,this.columns=[],this.travels=[],this.openDeleteDialog=!1}ngOnInit(){this.loadColumns()}loadColumns(){this.columns=[{header:"Nazwa",field:"name"},{header:"Data",field:"date"},{header:"Trasa",field:"route"}]}loadTravels(){this.routeService.getAll().subscribe(t=>{this.travels=t.body??[]})}onTravelSelected(t){this.selectedTravel=t}openTravelDialog(t){this.dialogService.open(C,{header:t?"Edytuj przew\xf3z":"Dodaj przew\xf3z",width:"60%",height:"60%",data:{edit:t,client:this.selectedTravel}}).onClose.subscribe(n=>this.handleTravelDialog(n))}openTravelDeleteDialog(t){this.openDeleteDialog=t}handleTravelDeleteDialog(t){t&&this.routeService.delete(this.selectedTravel?.travelId).subscribe({next:()=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"usuni\u0119to!"}),this.loadTravels()},error:()=>{this.messageService.add({key:"mainToast",severity:"error",summary:"Error",detail:"nie usuni\u0119to!"})}}),this.openDeleteDialog=!1}handleTravelDialog(t){t&&this.loadTravels()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(d.xA),e.Y36(h),e.Y36(p.ez))},a.\u0275cmp=e.Xpm({type:a,selectors:[["take-travel"]],decls:4,vars:5,consts:[[1,"table-with-buttons"],["tableName","Przewozy",3,"columns","values","showTableName","selected"],[3,"isSelectedItem","addActionEmit","editActionEmit","deleteActionEmit"],[3,"deleteConfirmationEmit",4,"ngIf"],[3,"deleteConfirmationEmit"]],template:function(t,l){1&t&&(e.TgZ(0,"div",0)(1,"fixtab-table",1),e.NdJ("selected",function(s){return l.onTravelSelected(s)}),e.qZA(),e.TgZ(2,"fixtab-table-buttons",2),e.NdJ("addActionEmit",function(s){return l.openTravelDialog(s)})("editActionEmit",function(s){return l.openTravelDialog(s)})("deleteActionEmit",function(s){return l.openTravelDeleteDialog(s)}),e.qZA()(),e.YNc(3,E,1,0,"fixtab-delete-dialog",3)),2&t&&(e.xp6(1),e.Q6J("columns",l.columns)("values",l.travels)("showTableName",!0),e.xp6(1),e.Q6J("isSelectedItem",null!==l.selectedTravel),e.xp6(1),e.Q6J("ngIf",l.openDeleteDialog))},dependencies:[D.a,S.Y,A.F,c.O5]}),a})()}];let z=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.Bz.forChild(I),m.Bz]}),a})(),N=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[z,T.K,v.hJ,c.ez,o.u5,o.UX]}),a})()}}]);