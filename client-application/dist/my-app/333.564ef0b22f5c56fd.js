"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[333],{333:(k,d,n)=>{n.r(d),n.d(d,{RoutesModule:()=>I});var c=n(6895),a=n(4006),m=n(5593),f=n(819);class R{constructor(s){this.routeId=s}}var e=n(8274),u=n(4325),v=n(7468),b=n(529);let p=(()=>{class o{constructor(t){this.http=t,this.url=v.T+"route"}getAll(){return this.http.get(this.url+"/getAllRoute",{observe:"response"})}getAllNotDeleted(){return this.http.get(this.url+"/getAllNotDeletedRoute",{observe:"response"})}create(t){return this.http.post(this.url+"/createRoute",t)}update(t){return this.http.put(this.url+"/editRoute",t)}delete(t){return this.http.delete(`${this.url}/deleteRoute/${t}`)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(b.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var h=n(805),y=n(1998);let C=(()=>{class o{constructor(t,i,r,l,x,J){this.fb=t,this.ref=i,this.config=r,this.routeService=l,this.messageService=x,this.changeDateService=J,this.routeForm=this.fb.group({name:["",a.kI.required],startingPoint:["",a.kI.required],endingPoint:["",a.kI.required],distance:["",[a.kI.required]]}),this.route=new R,this.edit=!1}ngOnInit(){this.edit=this.config.data.edit,this.edit&&(this.route=this.config.data.route)}onEditRoute(){this.routeService.update(this.route).subscribe({next:t=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"edytowano!"}),this.ref.close(t)},error:t=>{this.messageService.add({key:"mainToast",severity:"error",summary:"Error",detail:"nie edytowano!"})}})}onCreateRoute(){this.routeService.create(this.route).subscribe({next:t=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"utworzono!"}),this.ref.close(t)},error:t=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"utworzono!"})}})}onCloseDialog(){this.ref.close()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(a.QS),e.Y36(u.E7),e.Y36(u.S),e.Y36(p),e.Y36(h.ez),e.Y36(y.H))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fixtab-route-dialog"]],decls:16,vars:3,consts:[[1,"dialog-content"],[1,"dialog-body"],[1,"dialog-form",3,"formGroup"],["form","ngForm"],[1,"p-float-label"],["pInputText","","id","name","formControlName","name","placeholder","Nazwa trasy"],["pInputText","","id","startingPoint","formControlName","startingPoint","placeholder","Punkt startowy"],["pInputText","","id","endingPoint","formControlName","endingPoint","placeholder","Punkt docelowy"],["pInputText","","id","distance","formControlName","distance","placeholder","Odleg\u0142o\u015b\u0107[km]"],[1,"dialog-footer"],["styleClass","button-width dialog-button-margin",3,"label","disabled","onClick"],["styleClass","button-width dialog-button-margin",3,"onClick"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2,3)(4,"span",4),e._UZ(5,"input",5),e.qZA(),e.TgZ(6,"span",4),e._UZ(7,"input",6),e.qZA(),e.TgZ(8,"span",4),e._UZ(9,"input",7),e.qZA(),e.TgZ(10,"span",4),e._UZ(11,"input",8),e.qZA()()(),e.TgZ(12,"div",9)(13,"p-button",10),e.NdJ("onClick",function(){return i.edit?i.onEditRoute():i.onCreateRoute()}),e.qZA(),e.TgZ(14,"p-button",11),e.NdJ("onClick",function(){return i.onCloseDialog()}),e._uU(15,"Anuluj"),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.routeForm),e.xp6(11),e.Q6J("label",i.edit?"Edytuj":"Dodaj")("disabled",i.routeForm.invalid))},dependencies:[m.zx,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u],encapsulation:2}),o})();var D=n(9767),T=n(5378),S=n(434);function A(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"fixtab-delete-dialog",4),e.NdJ("deleteConfirmationEmit",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.handleRouteDeleteDialog(r))}),e.qZA()}}let Z=(()=>{class o{constructor(t,i,r){this.dialogService=t,this.routeService=i,this.messageService=r,this.selectedRoute=null,this.columns=[],this.routes=[],this.openDeleteDialog=!1}ngOnInit(){this.loadColumns()}loadColumns(){this.columns=[{header:"Nazwa",field:"name"},{header:"Punkt pocz\u0105tkowy",field:"startingPoint"},{header:"Punkt docelowy",field:"endingPoint"},{header:"Odleg\u0142o\u015b\u0107",field:"km"}]}loadRoutes(){this.routeService.getAll().subscribe(t=>{this.routes=t.body??[]})}onRouteSelected(t){this.selectedRoute=t}openRouteDialog(t){this.dialogService.open(C,{header:t?"Edytuj trase":"Dodaj trase",width:"60%",height:"60%",data:{edit:t,client:this.selectedRoute}}).onClose.subscribe(r=>this.handleRouteDialog(r))}openRouteDeleteDialog(t){this.openDeleteDialog=t}handleRouteDeleteDialog(t){t&&this.routeService.delete(this.selectedRoute?.routeId).subscribe({next:()=>{this.messageService.add({key:"mainToast",severity:"success",summary:"Success",detail:"usuni\u0119to!"}),this.loadRoutes()},error:()=>{this.messageService.add({key:"mainToast",severity:"error",summary:"Error",detail:"nie usuni\u0119to!"})}}),this.openDeleteDialog=!1}handleRouteDialog(t){t&&this.loadRoutes()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.xA),e.Y36(p),e.Y36(h.ez))},o.\u0275cmp=e.Xpm({type:o,selectors:[["fixtab-route"]],decls:4,vars:6,consts:[[1,"table-with-buttons"],["tableName","Trasy",3,"columns","values","showCaption","showTableName","selected"],[3,"isSelectedItem","addActionEmit","editActionEmit","deleteActionEmit"],[3,"deleteConfirmationEmit",4,"ngIf"],[3,"deleteConfirmationEmit"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"fixtab-table",1),e.NdJ("selected",function(l){return i.onRouteSelected(l)}),e.qZA(),e.TgZ(2,"fixtab-table-buttons",2),e.NdJ("addActionEmit",function(l){return i.openRouteDialog(l)})("editActionEmit",function(l){return i.openRouteDialog(l)})("deleteActionEmit",function(l){return i.openRouteDeleteDialog(l)}),e.qZA()(),e.YNc(3,A,1,0,"fixtab-delete-dialog",3)),2&t&&(e.xp6(1),e.Q6J("columns",i.columns)("values",i.routes)("showCaption",!0)("showTableName",!0),e.xp6(1),e.Q6J("isSelectedItem",null!==i.selectedRoute),e.xp6(1),e.Q6J("ngIf",i.openDeleteDialog))},dependencies:[D.a,T.Y,S.F,c.O5]}),o})();var g=n(5479);const E=[{path:"route",component:Z}];let N=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(E),g.Bz]}),o})(),I=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[N,f.K,m.hJ,c.ez,a.u5,a.UX]}),o})()}}]);